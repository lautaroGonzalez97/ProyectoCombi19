{% extends "cliente/homeCliente.html" %}
{% block panel %}

<link rel="stylesheet" href="{{ url_for ('static', filename='style_login.css') }}" />

<div style="width: 100%; display: flex; justify-content: center; margin-top: 2%;">
    <div class="col-4" style="text-align: center;">
        {% with mensajes= get_flashed_messages(category_filter=["error"])%}
        {% if mensajes %}
        {% for messages in mensajes%}
        <div class="alert alert-danger" role="alert">
            {{ messages }}
        </div>
        {% endfor %}
        {% endif %}
        {% endwith %}
        {% with mensajes= get_flashed_messages(category_filter=["success"])%}
        {% if mensajes %}
        {% for messages in mensajes%}
        <div class="alert alert-success" role="alert">
            {{ messages }}
        </div>
        {% endfor %}
        {% endif %}
        {% endwith %}
    </div>
</div>
<form name="form" action="{{url_for('comprar_viaje', id = viaje.id)}}" method="POST"></form>
<div class="container" style="align-content: center;">
    <table class="table" style="background-color: #FFFFFF80; width: 40% ;margin: 0 auto; border-collapse: collapse;">
        <thead>
            <h3 style="text-align: center;">Detalle Viaje</h3>
        </thead>
        <tbody>
            <tr>
                <td><strong>Origen:</strong> {{viaje.origen}}</td>
            </tr>
            <tr>
                <td><strong>Destino:</strong> {{viaje.destino}}</td>
            </tr>
            <tr>
                <td> <strong>Fecha:</strong> {{viaje.fecha}}</td>
            </tr>
            <tr>
                <td><strong>Salida:</strong> {{viaje.salida}}</td>
            </tr>
            <tr>
                <td><strong>Llegada:</strong> {{viaje.llegada}}</td>
            </tr>
            <tr>
                <td><strong>Precio:</strong> $<span id="precio">{{viaje.precio}}</span></td>
            </tr>
            <tr>
                <td><strong>Cantidad de boletos:</strong><input id="cantidad" type="number" value="1" name="cantidadBoletos" onclick="mult()"></td>
            </tr>
        </tbody>
    </table>
</div>
<br>
<h3 style="text-align: center;">Insumos</h3>
<div class="columns">
    <div class="column">
        <table class="table" style="background-color: #FFFFFF80;">
            <thead>
                <tr>
                    <th style="text-align: center">Nombre</th>
                    <th style="text-align: center">Tipo</th>
                    <th style="text-align: center">Precio</th>
                    <th style="text-align: center">Cantidad</th>
                </tr>
            </thead>
            <tbody>
                {% for p in insumos %}
                <tr>
                    <td style="text-align: center">{{p.nombre}}</td>
                    <td style="text-align: center">{{p.tipo}}</td>
                    <td style="text-align: center"><span id="precioInsumo">{{p.precio}}</span></td>
                    <td style="text-align: center"><input id="cant" type="number" value="0" name="canti" onkeyup="sumaInsumo()" onkeydown="restaInsumo()"></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
<div style="text-align: center; margin-top: 1%;">
    <div>
        <strong>
            <p>Precio Final: $<span id='suma'>{{viaje.precio}}</span></p>
            
        </strong> <!-- ACA IRIA LA SUMA DE LA CANTIDAD DE BOLETOS MAS EL PRECIO DE LOS INSUMOS-->
    </div>  
</div>
<div style="text-align: center;">
    <button type="submit" name="button" style="margin-top: 1%;" class="btn va_btn">Confirmar Compra</button>
    <!-- <a href="{{url_for('comprar_viaje', id = viaje.id)}}" >Confirmar
        Compra</a> -->
    <a href="{{url_for('home_cliente')}}" style="margin-top: 1%;" class="btn va_btn">Cancelar</a>
</div>
</form>
<script>
    function mult(){
        let precio = document.getElementById("precio").innerHTML
        let cant = document.form.cantidadBoletos.value
        document.getElementById('suma').innerHTML = (precio * cant)   

    }

    function sumaInsumo(){
        let precio = document.getElementById("precioInsumo").innerHTML
        console.log(precio)
        let total = document.getElementById('suma').innerHTML
        document.getElementById('suma').innerHTML = (parseInt(total) + parseInt(precio))   
    }

    function restaInsumo(){
        let precio = document.getElementById("precioInsumo").innerHTML
        console.log(precio)
        let total = document.getElementById('suma').innerHTML
        document.getElementById('suma').innerHTML = (parseInt(total) - parseInt(precio)) 
    }
</script>
{% endblock %}